"use strict";function createWaveformElements(e,t,n,a,o,r,i){var d=document.getElementById(e),m=document.createElement("div");m.id=t;var c=document.createElement("div");c.id=n;var s=document.createElement("audio");s.controls="controls",c.appendChild(s);var l=document.createElement("source");l.src=a,l.type=o;var u=document.createElement("source");u.src=r,u.type=i,s.appendChild(l),s.appendChild(u);var g=document.createElement("button");g.setAttribute("data-action","zoom-in"),g.innerHTML="zoom in";var v=document.createElement("button");v.setAttribute("data-action","zoom-out"),v.innerHTML="zoom out";var p=document.createElement("button");p.setAttribute("data-action","add-segment"),p.innerHTML="Add a Segment at current time";var f=document.createElement("button");f.setAttribute("data-action","remove-segments"),f.innerHTML="Remove all Segments";var h=document.createElement("button");h.setAttribute("data-action","add-point"),h.innerHTML="Add a Point at current time";var b=document.createElement("button");b.setAttribute("data-action","log-data"),b.innerHTML="Log segments/points";var E=document.createElement("button");E.setAttribute("data-action","return-segments"),E.innerHTML="Return segments",c.appendChild(g),c.appendChild(v),c.appendChild(p),c.appendChild(f),c.appendChild(h),c.appendChild(b),c.appendChild(E),d.appendChild(m),d.appendChild(c)}function setWaveformOptions(e,t,n){var a={container:document.getElementById(e),mediaElement:document.querySelector("audio"),dataUri:{arraybuffer:t,json:n},height:100,keyboard:!1,inMarkerColor:"#a0a0a0",outMarkerColor:"#a0a0a0",zoomWaveformColor:"#FF0000",overviewWaveformColor:"#FF0000",overviewHighlightRectangleColor:"#9BF4D5",segmentColor:"rgba(255, 161, 39, 1)",playheadColor:"rgba(0, 0, 0, 1)",playheadTextColor:"#aaa",pointMarkerColor:"#FF0000",axisGridlineColor:"#ccc",axisLabelColor:"#aaa"};return a}function makeWaveformSet(e){window.instance=e,document.querySelector('[data-action="zoom-in"]').addEventListener("click",e.zoom.zoomIn.bind(e)),document.querySelector('[data-action="zoom-out"]').addEventListener("click",e.zoom.zoomOut.bind(e)),document.querySelector('button[data-action="add-segment"]').addEventListener("click",function(){var t={startTime:e.time.getCurrentTime(),endTime:e.time.getCurrentTime()+5,editable:!0};e.segments.add([t])}),document.querySelector('button[data-action="remove-segments"]').addEventListener("click",function(){_removeAllTrackSegments(e)}),document.querySelector('button[data-action="return-segments"]').addEventListener("click",function(){console.log(_getTrackSegments(e))}),document.querySelector('button[data-action="add-point"]').addEventListener("click",function(){var t={timestamp:e.time.getCurrentTime(),editable:!0};e.points.add([t])}),document.querySelector('button[data-action="log-data"]').addEventListener("click",function(t){console.log("Segments",e.segments.getSegments()),console.log("Points",e.points.getPoints())}),e.on("segments.ready",function(){console.log("track loaded")})}!function(e){var t="first-waveform-visualiser-container";createWaveformElements("waveform-div",t,"demo-controls","./test_data/sample.mp3","audio/mpeg","./test_data/sample.ogg","audio/ogg");var n=e.init(setWaveformOptions(t,"/test_data/sample.dat","/test_data/sample.json"));makeWaveformSet(n)}(peaks.js);var _generateId=function(e){return e.name.toLowerCase()+"10"},_getTrackSegments=function(e){return e.segments.getSegments()},_removeTrackSegments=function(e,t,n){return e.segments.removeByTime(t,n)},_removeAllTrackSegments=function(e){return e.segments.removeAll()},xhr=new XMLHttpRequest;xhr.responseType="arraybuffer",xhr.open("GET","test_data/sample.dat"),xhr.addEventListener("load",function(e){var t=WaveformData.create(e.target);console.log(t);var n=t.resample({width:500});console.log(n.min.length);var n=t.resample({scale:3*t.adapter.scale}),a=t.resample({width:500,from:0,to:500}),o=function(e){var t=256;return function(n){return e-(n+128)*e/t}},r=document.getElementById("canvas-element"),i=o(r.height),d=r.getContext("2d");d.beginPath(),a.min.forEach(function(e,t){d.lineTo(t+.5,i(e)+.5)}),a.max.reverse().forEach(function(e,t){d.lineTo(a.offset_length-t+.5,i(e)+.5)}),d.closePath(),d.stroke()}),xhr.send();